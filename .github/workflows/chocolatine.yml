name: Chocolatine Project

on:
    push:
        branches-ignore:
        - "ga-ignore-*"
    pull_request:
        branches-ignore:
        - "ga-ignore-*"

env:
    MIRROR_URL: git@github.com:EpitechPGEPromo2029/B-DOP-200-PAR-2-1-chocolatine-nicky.truong.git
    EXECUTABLES: pain_au_chocolat

jobs:
    check_coding_style:
        name: "Coding style checker"
        runs-on: ubuntu-latest
        container:
            image: ghcr.io/epitech/coding-style-checker:latest
        steps:
            - uses: actions/checkout@v4
            - run: |
                check.sh $(pwd) $(pwd)
                CODING_STYLE_ERRORS=$(coding-style-reports.log)
                for ERRORS in $CODING_STYLE_ERRORS; do
                    array={echo $ERRORS}
                    echo "::error file=${array[i]#./},title=${array[3]#./}, the followed coding style errors has been detected: ${array[2]#./}::${array[4]#./}"
                done
                if [[ -n $CODING_STYLE_ERRORS ]]
                then
                    exit 1
                else
                    echo Clean code, no coding style errors detected
                fi